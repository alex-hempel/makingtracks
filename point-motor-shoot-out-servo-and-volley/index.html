<!DOCTYPE html><html lang="en-au"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Point Motor Shoot-Out, Servo and Volley - Making Tracks</title><meta name="description" content="Well over two years ago, I wrote about the conclusion of my quest to find point motors. At the time, the Cobalt motors became the solution of choice. But of course, that couldn't have been the end of it."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://makingtracks.ah-web.org/point-motor-shoot-out-servo-and-volley/"><link rel="alternate" type="application/atom+xml" href="https://makingtracks.ah-web.org/feed.xml"><link rel="alternate" type="application/json" href="https://makingtracks.ah-web.org/feed.json"><meta property="og:title" content="Point Motor Shoot-Out, Servo and Volley"><meta property="og:image" content="https://makingtracks.ah-web.org/media/posts/42/img_5575-scaled.jpg"><meta property="og:image:width" content="2560"><meta property="og:image:height" content="1440"><meta property="og:site_name" content="Making Tracks"><meta property="og:description" content="Well over two years ago, I wrote about the conclusion of my quest to find point motors. At the time, the Cobalt motors became the solution of choice. But of course, that couldn't have been the end of it."><meta property="og:url" content="https://makingtracks.ah-web.org//point-motor-shoot-out-servo-and-volley/"><meta property="og:type" content="article"><link rel="preload" href="https://makingtracks.ah-web.org/assets/dynamic/fonts/cabin/cabin.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://makingtracks.ah-web.org/assets/dynamic/fonts/cabin/cabin-italic.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://makingtracks.ah-web.org/assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="https://makingtracks.ah-web.org/assets/css/style.css?v=794aad8980e1685dc43a66fdf0d1c365"><noscript><link rel="stylesheet" href="https://makingtracks.ah-web.org/assets/css/noscript.css?v=efa867a99f5064d6729e4dc2008ad50b"></noscript><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://makingtracks.ah-web.org/point-motor-shoot-out-servo-and-volley/"},"headline":"Point Motor Shoot-Out, Servo and Volley","datePublished":"2023-01-22T20:03+10:00","dateModified":"2025-01-21T21:09+10:00","image":{"@type":"ImageObject","url":"https://makingtracks.ah-web.org/media/posts/42/img_5575-scaled.jpg","height":1440,"width":2560},"description":"Well over two years ago, I wrote about the conclusion of my quest to find point motors. At the time, the Cobalt motors became the solution of choice. But of course, that couldn't have been the end of it.","author":{"@type":"Person","name":"Alex","url":"https://makingtracks.ah-web.org/authors/alex/"},"publisher":{"@type":"Organization","name":"Alex"}}</script><style>#wrapper > .bg {
               background-image: url(https://makingtracks.ah-web.org/assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url(https://makingtracks.ah-web.org/media/website/cropped-train-1148965_1920-6.png);
           }</style><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><link rel="stylesheet" href="https://makingtracks.ah-web.org/media/plugins/simpleLightboxGallery/venobox.min.css"></head><body class="is-preload post-template"><div id="wrapper"><header id="header"><a class="logo" href="https://makingtracks.ah-web.org/">Making Tracks</a></header><nav id="nav"><ul class="links"><li><a href="https://makingtracks.ah-web.org/" target="_self">Home</a></li><li><a href="https://makingtracks.ah-web.org/about/" target="_self">About</a></li><li><a href="https://mastodon.social/@rainynight65" target="_blank">Mastodon</a></li><li><a href="https://makertube.net/c/makingtracks/videos" target="_blank">Makertube</a></li></ul></nav><main id="main"><article class="post"><header class="major"><time datetime="2023-01-22T20:03" class="date">22 January 2023</time><h1>Point Motor Shoot-Out, Servo and Volley</h1><p class="post__inner"></p></header><figure class="image main"><img src="https://makingtracks.ah-web.org/media/posts/42/img_5575-scaled.jpg" srcset="https://makingtracks.ah-web.org/media/posts/42/responsive/img_5575-scaled-xs.jpg 300w, https://makingtracks.ah-web.org/media/posts/42/responsive/img_5575-scaled-sm.jpg 480w, https://makingtracks.ah-web.org/media/posts/42/responsive/img_5575-scaled-md.jpg 768w, https://makingtracks.ah-web.org/media/posts/42/responsive/img_5575-scaled-lg.jpg 1024w, https://makingtracks.ah-web.org/media/posts/42/responsive/img_5575-scaled-xl.jpg 1360w" sizes="(max-width: 1360px) 100vw, 1360px" loading="lazy" height="1440" width="2560" alt=""></figure><div class="post__inner post__entry"><p></p><p>Well over two years ago, I wrote about the <a href="https://makingtracks.ah-web.org/2019/02/17/point-motor-shoot-out-final/" data-type="post" data-id="307">conclusion of my quest to find point motors</a>. At the time, the Cobalt motors became the solution of choice. But of course, that couldn't have been the end of it.</p><p></p><p></p><p>Why not? Because a bigger layout was always in the cards. And while the Cobalts were a good solution at the time, that solution wasn't going to scale well. Due to a unit price of now $50 Australian ($37.50 if bought in a set of 12), they are simply very costly. Once I had determined the new track plan, with a grand total of 31 points, I gulped twice and shelved the idea of buying more of these motors.</p><p></p><p></p><p>Or any other bespoke point motors, for that matter. There are a few options, but none of them are suitable for people with small budgets, at least not in quantities. With time, the solution became more obvious: servos.</p><p></p><p></p><p>The SG90 servo is ubiquitous, affordable, and has a good reputation. Decoder options for operating servos are numerous, and ranging from very affordable to luxurious. Servos are strong enough to throw points with over-centre springs, something the Cobalts couldn't do. This has advantages and drawbacks - the spring guarantees a snug alignment of the point's end positions, but leaving it in place sacrifices the slow, smooth point movement.</p><p></p><p></p><p>But there are a few more things to consider when using servos. Where bespoke motors are built specifically to be mounted below board or next to railway track, servos are more universal and therefore need mounts suited for the intended purpose. Bespoke motors usually come either with built-in digital capability, or are operated by regular accessory decoders. Servos on the other hand, due to the way they operate with PWM pulses on the signal connector, need specific decoders to be operated.</p><p></p><p></p><p>I researched all those things at length before I took the plunge. Some manufacturers offer servo decoders as part of their range, but there are also a number of homebrew solutions. I ended up going with a familiar option. In previously conducted <a href="https://makingtracks.ah-web.org/2020/06/30/feedback-experiments-pt-ii/" data-type="post" data-id="606">feedback experiments</a> I used the ArLoco shield provided by the <a rel="noreferrer noopener" href="https://www.arcomora.com/" target="_blank">ArCoMoRa project</a>. The same project also makes the Mardec software, another Arduino-based solution for the control of accessories and LEDs. This software, like the ArLoco, works with a custom Arduino shield, but it can also be used with the ArCoMoRa DCCNext decoder. That decoder is effectively an all-in-one solution using the ATMEGA328P chip and a custom circuit. One DCCNext can control up to 12 servos, which is a darn sight more cost-effective than most bespoke servo controllers.</p><p></p><p></p><p>For the mount, it was mostly a case of exploring well-known 3D printing sites, and I <a rel="noreferrer noopener" href="https://www.thingiverse.com/thing:3603598" target="_blank">found a mount</a> that looked suitable and had informative pictures with it. I do not own a 3D printer, but a friend of mine printed a whole stack of these mounts for me, enough to cover all my planned points and have a few spares. The mounts came out great, the SG90 servos fit very snugly.</p><p></p><p></p><p>As far as the throw wires are concerned, a number of different opinions can be found. The Cobalt motors use piano wire or spring steel wire, and some people recommend using the same for servos. These throw wires have a bit of flexibility and therefore exert more force on the tie bar, keeping the blades securely in their end position. Others say that it is sufficient to use regular steel or even brass wire, as long as it is stiff enough. For starters, I decided to experiment with straightened paper clips - that kind of steel wire is not springy, but easy enough to bend into shape.</p><div class="gallery-wrapper"><div class="gallery" data-is-empty="false" data-translation="Add images" data-columns="3"><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5575.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="All the parts needed for a servo-based point motor: the servo itself, throwing arms, a mount, and the paper clip for the throwing wire"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5575-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>All the parts needed for a servo-based point motor: the servo itself, throwing arms, a mount, and the paper clip for the throwing wire</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5576.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="The SG90 in its mount"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5576-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>The SG90 in its mount</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5584.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="The DCCNext decoder, fully assembled…"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5584-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>The DCCNext decoder, fully assembled…</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5582.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="And a peek under the hood"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5582-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>And a peek under the hood</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5577.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="The centring aid, made from a 10mm wall anchor and a push pin"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5577-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>The centring aid, made from a 10mm wall anchor and a push pin</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5578.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="Two servos fully installed"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5578-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>Two servos fully installed</figcaption></figure><figure class="gallery__item"><a href="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5579.jpg" data-size="4032x2268" data-gall="galleryGroup-1" data-title="A closer look"><img loading="lazy" src="https://makingtracks.ah-web.org/media/posts/42/gallery/img_5579-thumbnail.jpg" alt="" width="720" height="405"></a><figcaption>A closer look</figcaption></figure></div></div><p></p><p></p><p></p><p></p><p>Installing these servos is reasonably easy, but with the track already in place it requires partial track removal. First I mark out the centre position of the tie bar. After removal of the point, a 10mm hole is drilled through the base board. The servo mount is installed centre-on below that hole, and the throw wire is guided through the hole. Lastly, the point is replaced with the throw wire going through the tie bar centre hole.</p><p></p><p></p><p>There was a small snag though. Due to the shape of the mounts, it isn't easy to tell whether it is centred in relation to the hole in the baseboard - at least not unless you can be both above and below the table at the same time. Since I tend to stick the mounts in place with double-sided tape, I needed an aid. After trying a few things, I combined a push pin and a 10mm plastic wall plug (normally used to anchor screws in masonry). This centring aid is guided through the hole from the bottom. The fulcrum hole in the servo mount then goes onto the pin. Once everything is in place, the centring aid is removed from the top before reinstalling the point. This has worked very well in the installs I've done so far.</p><p></p><p></p><p>With the DCCNext decoder, I had the option to connect all three servo pins directly to the decoder, or to only connect the signal wire, while feeding the servos from a separate 5V bus. I opted for the latter, because it makes wiring somewhat easier. The 5V bus has to go around most of the layout anyway, so feeder wires from the bus to the servos will be quite short. The signal wires appear to be able to handle some length - 4m of wire salvaged from a Cat5 network cable between the servo and the controller have been issue-free so far.</p><p></p><p></p><p>The first thing I noticed after installing a few servos and operating them was how utterly quiet they are. The Cobalts always made an ungodly noise when switching, which was usually amplified by the baseboard and could even be heard over the running noise of trains. The servos make barely a sound, certainly nothing that will be heard once trains are going. That almost makes it useful to leave the centre springs in place, since their snap gives a bit of an audible confirmation that the point has actually switched.</p><p></p><p></p><p>The following short video clip shows the throwing action from above.</p><div class="post__iframe"><iframe loading="lazy" width="700" height="394" style="width: 700px; height: 394px;" title="Servo-driven point motor" src="https://makertube.net/videos/embed/7613e583-10c4-4682-bee7-a663de67d0e0?title=0&amp;peertubeLink=0" frameborder="0" allowfullscreen="allowfullscreen" sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe></div><p>As always, thanks for following along!</p><p></p></div><footer class="post__inner post__footer"><div class="post__share-tag-container"><div class="post__tag"><h3>Tagged in:</h3><ul><li><a href="https://makingtracks.ah-web.org/tags/arduino/">Arduino</a></li><li><a href="https://makingtracks.ah-web.org/tags/dcc/">DCC</a></li><li><a href="https://makingtracks.ah-web.org/tags/point-motors/">Point Motors</a></li><li><a href="https://makingtracks.ah-web.org/tags/points/">Points</a></li></ul></div><div class="post__share"><button class="post__share-button js-post__share-button icon" aria-label="Share button"><i class="fas fa-share-alt"></i></button><div class="post__share-popup js-post__share-popup"></div></div></div><div class="post__bio"><img src="https://www.gravatar.com/avatar/ee5c2941d2997b864e9173c270513a0c?s&#x3D;240" loading="lazy" height="240" width="240" alt="Alex"><div><h3><a href="https://makingtracks.ah-web.org/authors/alex/" class="invert" rel="author">Alex</a></h3></div></div></footer></article><div><strong>You should also read:</strong></div><div class="posts"><article><header><time datetime="2019-02-17T14:01" class="date">17 February 2019</time><h2><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-final/">Point Motor Shoot-Out, Final</a></h2></header><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-final/" class="image fit"><img src="https://makingtracks.ah-web.org/media/posts/19/img_0693.jpg" srcset="https://makingtracks.ah-web.org/media/posts/19/responsive/img_0693-xs.jpg 300w, https://makingtracks.ah-web.org/media/posts/19/responsive/img_0693-sm.jpg 480w, https://makingtracks.ah-web.org/media/posts/19/responsive/img_0693-md.jpg 768w, https://makingtracks.ah-web.org/media/posts/19/responsive/img_0693-lg.jpg 1024w, https://makingtracks.ah-web.org/media/posts/19/responsive/img_0693-xl.jpg 1360w" sizes="(max-width: 1360px) 100vw, 1360px" loading="lazy" height="3024" width="4032" alt=""></a><p>It's been a long time coming, but the saga of my point motors had to come to a conclusion eventually. You may recall&hellip;</p><ul class="actions special"><li><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-final/" class="button">Full Story</a></li></ul></article><article><header><time datetime="2018-05-14T09:18" class="date">14 May 2018</time><h2><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-pt-ii5/">Point Motor Shoot-out, Pt II.5</a></h2></header><p>Did I say I got lucky? Well, no. Just as I was setting up a new, more potent laptop with DCC control software,&hellip;</p><ul class="actions special"><li><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-pt-ii5/" class="button">Full Story</a></li></ul></article><article><header><time datetime="2018-04-10T08:50" class="date">10 April 2018</time><h2><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-pt-ii/">Point motor Shoot-out, Pt. II</a></h2></header><p>When I first played around with point motors not too long ago, I came across some differences between the Peco and Hornby motors&hellip;</p><ul class="actions special"><li><a href="https://makingtracks.ah-web.org/point-motor-shoot-out-pt-ii/" class="button">Full Story</a></li></ul></article><article><header><time datetime="2018-03-05T10:53" class="date">5 March 2018</time><h2><a href="https://makingtracks.ah-web.org/point-motor-shoot-out/">Point motor Shoot-out</a></h2></header><p>When, as a kid, I was mucking around with my TT-scale setup, there were precisely two kinds of points (or turnouts) you could&hellip;</p><ul class="actions special"><li><a href="https://makingtracks.ah-web.org/point-motor-shoot-out/" class="button">Full Story</a></li></ul></article></div></main><footer id="copyright"><ul><li>© Alex Hempel 2018-2025. All Rights Reserved</li><li>Design: <a href="https://html5up.net" target="_blank" rel="nofollow noopener">HTML5 UP</a></li><li>Powered by Publii</li></ul></footer></div><script src="https://makingtracks.ah-web.org/assets/js/jquery.min.js?v=c9771cc3e90e18f5336eedbd0fffb2cf"></script><script src="https://makingtracks.ah-web.org/assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script><script src="https://makingtracks.ah-web.org/assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script><script src="https://makingtracks.ah-web.org/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://makingtracks.ah-web.org/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://makingtracks.ah-web.org/assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script><script src="https://makingtracks.ah-web.org/assets/js/main.min.js?v=56233c354bd814758be8bff42f7e13a5"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script><script defer="defer" src="https://makingtracks.ah-web.org/media/plugins/simpleLightboxGallery/venobox.min.js"></script><script type="text/javascript">document.addEventListener("DOMContentLoaded", () => {
						 try {
							  if (typeof VenoBox !== 'undefined') {
									new VenoBox({
										 selector: '.gallery__item a',
titleattr: 'data-title',
bgcolor: 'rgba(38, 40, 44, 1)',
fitView: true,
infinigall: true,
maxWidth: '100%',
navigation: true,
navKeyboard: true,
navTouch: true,
navSpeed: 300,
numeration: true,
overlayClose: true,
overlayColor: 'rgba(0,0,0,0.8)',
share: false,
shareStyle: 'pill',
spinColor: '#d2d2d2',
spinner: 'flow',
titlePosition: 'top',
titleStyle: 'transparent',
toolsBackground: '#1C1C1C',
toolsColor: '#d2d2d2',
initialScale: 0.9,
transitionSpeed: 200
									});
							  } else {
									console.error("VenoBox script not loaded.");
							  }
						 } catch (error) {
							  console.error("Failed to initialize VenoBox:", error);
						 }
					});</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="#not-specified">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies. <a href="#not-specified">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title no-desc">Required</summary></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="analytics" id="analytics-cookies"> <label for="analytics-cookies">Required</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        initialLsState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                    'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                    'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                    'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                    'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                    'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                    'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                });  
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': window.publiiCBGCM.defaultState.ad_storage ? 'granted' : 'denied',
                        'ad_personalization': window.publiiCBGCM.defaultState.ad_personalization ? 'granted' : 'denied',
                        'ad_user_data': window.publiiCBGCM.defaultState.ad_user_data ? 'granted' : 'denied',
                        'analytics_storage': window.publiiCBGCM.defaultState.analytics_storage ? 'granted' : 'denied',
                        'personalization_storage': window.publiiCBGCM.defaultState.personalization_storage ? 'granted' : 'denied',
                        'functionality_storage': window.publiiCBGCM.defaultState.functionality_storage ? 'granted' : 'denied',
                        'security_storage': window.publiiCBGCM.defaultState.security_storage ? 'granted' : 'denied'
                    }));
                }
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            cbConfig.initialLsState = currentConfig.split(',');

            if (window.publiiCBGCM) {
                gtag('consent', 'default', {
                    'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                    'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                    'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                    'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                    'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                    'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                    'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                });
                
                if (cbConfig.debugMode) {
                    console.log('🍪 GCMv2 DEFAULT STATE: ' + JSON.stringify({
                        'ad_storage': getDefaultConsentState(currentConfig, 'ad_storage'),
                        'ad_personalization': getDefaultConsentState(currentConfig, 'ad_personalization'),
                        'ad_user_data': getDefaultConsentState(currentConfig, 'ad_user_data'),
                        'analytics_storage': getDefaultConsentState(currentConfig, 'analytics_storage'),
                        'personalization_storage': getDefaultConsentState(currentConfig, 'personalization_storage'),
                        'functionality_storage': getDefaultConsentState(currentConfig, 'functionality_storage'),
                        'security_storage': getDefaultConsentState(currentConfig, 'security_storage')
                    }));
                }
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function getDefaultConsentState (currentConfig, consentGroup) {
        let configGroups = currentConfig.split(',');

        for (let i = 0; i < configGroups.length; i++) {
            let groupName = configGroups[i];
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === groupName);

            if (group && group[consentGroup]) {
                return 'granted';
            }
        }  
        
        if (window.publiiCBGCM.defaultState[consentGroup]) {
            return 'granted'; 
        }
        
        return 'denied';
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }

        if (window.publiiCBGCM && cbConfig.initialLsState.indexOf(allowedGroup) === -1) {
            let consentResult = {};
            let group = window.publiiCBGCM.groups.find(group => group.cookieGroup === allowedGroup);

            if (group) {
                let foundSomeConsents = false;

                Object.keys(group).forEach(key => {
                    if (key !== 'cookieGroup' && group[key] === true) {
                        consentResult[key] = 'granted';
                        foundSomeConsents = true;
                    }
                });

                if (foundSomeConsents) {
                    gtag('consent', 'update', consentResult);   

                    if (cbConfig.debugMode) {
                        console.log('🍪 GCMv2 UPDATE: ' + JSON.stringify(consentResult));
                    }
                }
            }
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupToCheck !== '' && groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>